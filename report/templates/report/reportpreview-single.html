{% extends "report/layout.html" %} 
{% block content %} 

    <style>
        /*基本格式*/
        p{margin:0;}
        p.smalltwo{font-size:24px;font-weight: bold;font-family:Times New Roman,宋体;text-align:center;line-height: 25px;} /*小二号字体*/
        p.smallthree{font-size:20px;font-weight: bold;font-family:Times New Roman,宋体;text-align:center;line-height: 25px;} /*小三号字体*/
        p.four{font-size:18.6px;font-weight: bold;font-family:Times New Roman,宋体;text-align:center;line-height: 25px;} /*四号字体*/
        p.smallfour{font-size:16px;font-weight: bold;font-family:Times New Roman,宋体;line-height: 25px;} /*小四号字体*/
        p.five{font-size:14px;font-family:Times New Roman,宋体;text-indent:2em;text-align:justify;line-height: 25px;} /*五号字体*/

        /*页眉页脚格式*/
        div.thead{font-size:14px;font-family:Times New Roman,宋体;text-align:center;} 
        div.tfoot{font-size:14px;font-style:oblique;font-family:Times New Roman,宋体;color:rgba(255,255,255,0);} /*color:rgba(255,255,255,0)为设置字体透明色的语法*/
        pageFooter {display: table-footer-group;}
        pageFooter:after {counter-increment: page;content: counter(page);}

        /*表格格式*/
        /* table.report-container {page-break-after:left;} */ 

        table.mainbody{
            table-layout:fixed;   /*table表格宽度固定，同时td内容过长也不会被撑开*/
            word-break:break-all; /*table表格宽度固定，同时td内容过长也不会被撑开*/
            border-collapse:collapse; /* 关键属性：合并表格内外边框(其实表格边框有2px，外面1px，里面还有1px哦) */
            border: 2px solid #000;
            border-left:none;
            border-right:none;
            width: 580;
        } 

        /* .left-1{
        border:solid #000000;border-width:1px 0px 2px 0px;padding:2px;
        font-weight:bolder;
        }
        .right-1{
            border:solid #000000;border-width:1px 0px 2px 0px;padding:2px;
            font-weight:bolder;
        }
        .mid-1{
            border:solid #000000;border-width:1px 0px 2px 0px;padding:2px;
            font-weight:bolder;
        } */

        .down-1{
            border: 2px solid #000;
            border-left:none;
            border-right:none;
            border-top:none;
        }

        .topdown-1{
            border: 2px solid #000;
            border-left:none;
            border-right:none;
            text-align: center;
            font-weight: bold;
        }

        table.always{
            page-break-after: always;
        }
        .always:last-child{
            page-break-after: auto;
        }   /* 解决打印时多出一页的问题 */

        thead.report-header {display:table-header-group;
        }
        tfoot.report-footer {display:table-footer-group;
                bottom: 0;
                left: 0;
                /* position: fixed; */
                right: 0;}

        caption{font-size:16px;font-weight: bold;font-family:Times New Roman,宋体;} 
        th.title{font-weight:bold;font-family:Times New Roman,宋体;text-align:center;} /*表格中的表格字体*/
        td.five{font-family:Times New Roman,宋体;text-align:center;} /*表格中的字体设置为五号字体*/
        td.end{border: 1px solid transparent;}  /*报告编辑处的表格*/
        td.bottom{border-bottom:none;} /*报告的表格不显示底部边框*/
        td.top{border-top:none;} /*报告的表格不显示顶部边框*/
        div.offset{
            position: relative;
            left:0px;
            top:20px;}

        /*图片格式*/
        p.picture{font-size:14px;font-family:Times New Roman,宋体;font-weight: bold;text-align:center;line-height:1.5;} 

        /*输入框格式*/
        input{
            border-bottom: 1px solid #000;
            border-top: 0px;
            border-left: 0px;
            border-right: 0px;
        }      
    </style>

{% load myfilter %}
    <body class="word">
        <div>
            <table class="always" width="100%" style="height: 490px;" cellpadding="25"> <!--cellpadding="25"设置打印时的内外边距-->
                <thead class="report-header">
                    <tr>
                        <th class="report-header">
                            <div class="text-left"><img src="/static/report/img/4.png" height="35px" width="90px"/></div>
                            <div class="thead" >广州金域医学检验中心有限公司</div>  
                            <div class="thead" >Guangzhou Kingmed Center for Clinical Laboratory</div> 
                            <div style="width:100%; height:2px; border-top:1.2px solid 	#000000; clear:both;"></div>  <!--页眉文字下方添加横线的代码-->           
                        </th>
                    </tr>
                </thead>

                <tfoot class="report-footer">
                    <tr>
                        <td class="report-footer-cell">
                            <div class="tfoot">&#12288</div>
                            <div class="tfoot">&#12288</div>
                        </td>
                    </tr>
                </tfoot>

    <!------------------------------------------------------封面------------------------------------------------------> 
                <tbody class="report-content" id="content">              
                    <tr>
                        <td class="report-content-cell">
                            <br><br>
                            <p class="smalltwo">VALIDATION PROTOCOL AND REPORT</p>
                            <br><br><br><br>
                            <p class="smalltwo">方法验证报告</p>
                            <br><br><br><br>
                            {% if english_title %}
                                <p class="four">{{english_title}}</p>
                                <br><br><br><br>
                            {% else %}
                                <p class="four">英文标题未设置！</p>
                                <br><br><br><br>
                            {% endif %}
                            {% if chinese_title %}
                                <p class="four">{{chinese_title}}</p>
                                <br><br>
                            {% else %}
                                <p class="four">中文标题未设置！</p>
                                <br><br>
                            {% endif %}             
                            <p class="four">仪器编号：{{Instrument_number}}</p>
                            <br><br>
                            <p class="four">仪器型号：{{Instrument_model}}</p>
                            <br><br>
                            {% if ColumnTrue %}
                                <p class="four">色谱柱：{{Column}}</p>
                                <br><br><br><br>
                            {% else %}
                                <p class="four" style="visibility:hidden;">色谱柱：{{Column}}</p>
                                <br><br><br><br>
                            {% endif %}                          
                            <p class="smallthree">Protocol ID：{{Protocol_ID}}</p>
                            <br>
                            <p class="smallthree">代码：{{Protocol_ID}}</p>
                            <br><br><br><br><br><br><br>
    
     <!------------------------------------------------------正文------------------------------------------------------> 

                            {% if chinese_title %}
                            <p class="smallthree">{{chinese_title}}</p>
                            <br>
                            {% else %}
                            <p class="smallthree">中文标题未设置！</p>
                            <br>
                            {% endif %}
                            <p class="four" style="text-align:left;">1. 验证原因（Validation Reason）</p>
                            <p class="five">{{text_Validation_Reason.0}}</p>

    <!------------------------------------------------------仪器条件------------------------------------------------------> 
                            <p class="four" style="text-align:left;">2. 仪器条件（Instrument Conditions）</p>
                            <p class="five">检测仪器：{{Instrument_model}}（仪器编号：{{Instrument_number}}）</p>
                            {% if ColumnTrue %}
                                <p class="five">色谱柱：{{Column}}</p>
                            {% endif %}                    
                            <p class="smallfour">2.1 质谱方法（HPLC Method）</p>
                            {% for r in resulttest_method.zp_method_texts_list %}
                                <p class="five">{{r}}</p>
                            {% endfor %}
                                <table class="mainbody"  cellpadding="4" width="700" align="center">
                                    <caption>表1.质谱参数</caption>
                                    <tr>
                                        <th class="title topdown-1" width="20%">分析物名称</th>
                                        <th class="title topdown-1">母离子</th>
                                        <th class="title topdown-1">子离子</th>
                                        <th class="title topdown-1">TIME(S)</th>
                                        <th class="title topdown-1" width="20%">CONE(V)</th>
                                        <th class="title topdown-1" width="20%">COLLISION(V)</th>
                                    </tr>                                               
                                    {% for r in resulttest_method.zp_method_list %}
                                        <tr>
                                            {% for c in r %}
                                                <td class="five">{{c}}</td>
                                            {% endfor %}
                                        </tr>                            
                                    {% endfor %}
                                </table>  
                            <br>
                            <p class="smallfour">2.2 液相方法（MS Method）</p>
                            {% for r in resulttest_method.yx_method_texts_list %}
                                <p class="five">{{r}}</p>
                            {% endfor %}
                                <table class="mainbody" cellpadding="4" width="700" align="center">
                                    <caption>表2.液相梯度条件</caption>
                                    <tr>
                                        <th class="title topdown-1" width="20%">步骤</th>
                                        <th class="title topdown-1" width="20%">分析时间(min)</th>
                                        <th class="title topdown-1" width="20%">流速(mL/min)</th>
                                        <th class="title topdown-1" width="20%">流动相B%</th>
                                        <th class="title topdown-1" width="20%">流动相A%</th>
                                    </tr>                            
                                    {% for r in resulttest_method.yx_method_list %}
                                        <tr>
                                            {% for c in r %}
                                                <td class="five">{{c}}</td>
                                            {% endfor %}
                                        </tr>                            
                                    {% endfor %}
                                </table>
                            <br>
    <!------------------------------------------------------设备------------------------------------------------------> 
                            <p class="four" style="text-align:left;">3. 设备（Instrument）</p>
                            <p class="smallfour">3.1 检测设备（Detection equipment）</p>
                            {% for r in resultequipment.Detection_equipment_texts_list %}
                                <p class="five">{{r}}</p>
                            {% endfor %}
                            <p class="smallfour">3.2 辅助设备（Auxiliary equipment）</p>
                            {% for r in resultequipment.Auxiliary_equipment_texts_list %}
                                <p class="five">{{r}}</p>
                            {% endfor %}
            <!------------------------------------------------------试剂耗材------------------------------------------------------> 
                            <p class="four" style="text-align:left;">4. 试剂和耗材（Reagents and Consumables）</p>
                            <p class="smallfour">4.1 主要试剂（Reagents）</p>
                            {% for r in resultReagents_Consumables.reagents_texts_list %}
                                <p class="five">{{r}}</p>
                            {% endfor %}
                            <p class="smallfour">4.2 主要耗材（Consumables）</p>
                            {% for r in resultReagents_Consumables.consumables_texts_list %}
                                <p class="five">{{r}}</p>
                            {% endfor %}
        <!------------------------------------------------------样品处理------------------------------------------------------> 
                            <p class="four" style="text-align:left;">5. 样品处理（Sample Preparation）</p>
                            {% for r in resultSample_Preparation.Sample_Preparation_texts_list %}
                                <p class="five">{{r}}</p>
                            {% endfor %}

    <!------------------------------------------------------分界线------------------------------------------------------>      

    <!------------------------------------------------------精密度------------------------------------------------------> 
                            {% if resultPN.JMD_endreport_dict or resultPJ.JMD_endreport_dict %}
                                <p class="four" style="text-align:left;">{{JMDindex}}. 精密度（Precision）</p>
                            {% endif %}

                            {% if resultPN.JMD_endreport_dict %}
                                <p class="smallfour">{{JMDindex}}.{{PNjmdindex}}  重复性精密度（Intra-assay Precision）</p>
                                    {% for r in resultPN.textlist %}
                                    <p class="five"> {{forloop.counter}}) {{r}}</p>
                                    {% endfor %}
                                <p class="five">{{resultPN.serial}})  表{{tablePNindex}} 即为重复性精密度数据，{{resultPN.JMD_CONCLUSION}}</p>            
                                {%for key,value in resultPN.JMD_endreport_dict.items %}              
                                    <table class="mainbody"cellpadding="4" width="700"  align="center">
                                        <caption>表{{tablePNindex}}. {{key}}重复性精密度实验数据</caption>
                                        {% if resultPN.lownum %}                         
                                            <tr>
                                                <th class="title topdown-1">实验号</th>
                                                <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                            </tr> 
                                        {% elif resultPN.mediannum %}
                                            <tr>
                                                <th class="title topdown-1">实验号</th>
                                                <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>             
                                            </tr> 
                                        {% elif resultPN.highnum %}
                                            <tr>
                                                <th class="title topdown-1">实验号</th>
                                                <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>             
                                            </tr> 
                                        {% else %}    
                                            <tr>
                                                <th class="title topdown-1">实验号</th>
                                                <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                            </tr>
                                        {% endif %}                                                            
                                        {% for r in value %}
                                            <tr>
                                                {% for c in r %}
                                                    <td class="five">{{c}}</td>
                                                {% endfor %}
                                            </tr>                            
                                        {% endfor %}
                                    </table>
                                    <br>
                                {% endfor %}
                            {% endif %}
    
                            {% if resultPJ.JMD_endreport_dict %}
                                <p class="smallfour">{{JMDindex}}.{{PJjmdindex}}  中间精密度（Inter-assay Precision）</p>
                                    {% for r in resultPJ.textlist %}
                                    <p class="five"> {{forloop.counter}}) {{r}}</p>
                                    {% endfor %}
                                <p class="five">{{resultPJ.serial}})  表{{tablePJindex}} 即为中间精密度数据，{{resultPJ.JMD_CONCLUSION}}</p>
                                    {%for key,value in resultPJ.JMD_endreport_dict.items %}             
                                        <table class="mainbody" cellpadding="4" width="700" align="center">
                                            <caption>表{{tablePJindex}}. {{key}}中间精密度实验数据</caption>
                                            {% if resultPJ.lownum %}                         
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr> 
                                            {% elif resultPJ.mediannum %}
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>             
                                                </tr> 
                                            {% elif resultPJ.highnum %}
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>             
                                                </tr> 
                                            {% else %}    
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% endif %}                                                    
                                            {% for r in value %}
                                                <tr>
                                                    {% for c in r %}
                                                        <td class="five">{{c}}</td>
                                                    {% endfor %}
                                                </tr>                            
                                            {% endfor %}
                                        </table>
                                        <br>
                                    {% endfor %}
                            {% endif %}
                            
                            {% if resultPN.JMD_endreport_dict and resultPJ.JMD_endreport_dict %}
                                <p class="smallfour">{{JMDindex}}.{{JMDendconclusionindex}}  精密度验证结果汇总（Summary of the precision study）</p>
                                <p class="five">精密度实验验证结果如表{{tablejmdendconclusionindex}}所示，{{resultjmdendconclusion.JMD_CONCLUSION}}</p>
                                    <table class="mainbody" cellpadding="4" width="700" align="center">
                                        <caption>表{{tablejmdendconclusionindex}}. 精密度实验结果汇总</caption>
                                        <tr>
                                            <th class="title topdown-1">化合物</th>
                                            <th class="title topdown-1">类别</th>
                                            <th class="title topdown-1" width="27%">项目</th>
                                            <th class="title topdown-1" width="13%">低浓度</th>
                                            <th class="title topdown-1" width="13%">中浓度</th>
                                            <th class="title topdown-1" width="13%">高浓度</th>
                                        </tr>
                                        {%for key,value in resultjmdendconclusion.JMD_CONCLUSION_table.items %}
                                            <tr>
                                                <td class="five down-1" rowspan="6">{{key}}</td>
                                                <td class="five" rowspan="3">重复性精密度</td>
                                                <td class="five">测定次数（次）</td>
                                                <td class="five">{{value.0}}</td>
                                                <td class="five">{{value.1}}</td>
                                                <td class="five">{{value.2}}</td>                          
                                            </tr>     
                                            <tr>
                                                <td class="five">平均值（{{Unitdict|get_item:key|default:unit}}）</td>
                                                <td class="five">{{value.3}}</td>
                                                <td class="five">{{value.4}}</td>
                                                <td class="five">{{value.5}}</td>                          
                                            </tr>   
                                            <tr>
                                                <td class="five">CV（%）</td>
                                                <td class="five">{{value.6}}</td>
                                                <td class="five">{{value.7}}</td>
                                                <td class="five">{{value.8}}</td>                          
                                            </tr>
                                            <tr>
                                                <td class="five down-1" rowspan="3">中间精密度</td>
                                                <td class="five">测定次数（次）</td>
                                                <td class="five">{{value.9}}</td>
                                                <td class="five">{{value.10}}</td>
                                                <td class="five">{{value.11}}</td>                          
                                            </tr>     
                                            <tr>
                                                <td class="five">平均值（{{Unitdict|get_item:key|default:unit}}）</td>
                                                <td class="five">{{value.12}}</td>
                                                <td class="five">{{value.13}}</td>
                                                <td class="five">{{value.14}}</td>                          
                                            </tr>   
                                            <tr>
                                                <td class="five down-1">CV（%）</td>
                                                <td class="five down-1">{{value.15}}</td>
                                                <td class="five down-1">{{value.16}}</td>
                                                <td class="five down-1">{{value.17}}</td>                          
                                            </tr>
                                        {% endfor %}
                                    </table>
                                <br>
                            {% endif %}
                        
    
    <!------------------------------------------------------准确度------------------------------------------------------>
                            {% if resultPT or resultrecycle.Recycle_endreport_dict %}
                                <p class="four" style="text-align:left;">{{ZQDindex}}. 准确度（Accuracy）</p>
                            {% endif %}

                            {% if resultPT %}
                                <p class="smallfour">{{ZQDindex}}.{{PTindex}}  室间质量评价（Proficiency Testing, PT）</p>
                                    {% for r in resultPT.textlist %}
                                        <p class="five"> {{forloop.counter}}) {{r}}</p>
                                    {% endfor %}
                                <p class="five">{{resultPT.serial}})  实验结果如表{{tablePTindex}}所示,结果表明检测结果均在可接受范围内，说明该方法的正确度满足要求。</p>
                                    {%for key,value in resultPT.PT_endreport_dict.items %}
                                        <table class="mainbody" cellpadding="4" width="700" align="center">
                                            <caption>表{{tablePTindex}}. {{key}}验证结果</caption>
                                            <tr>
                                                <th class="title topdown-1" width="20%">样本编号</th>
                                                <th class="title topdown-1" width="20%">检测值<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                                <th class="title topdown-1" width="20%">靶值<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                                <th class="title topdown-1" width="20%">可接受标准</th>
                                                <th class="title topdown-1" width="20%">偏倚(%)或<br/>绝对差值<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                            </tr>
                                            {%for r in value %}
                                            <tr>
                                                {%for c in r %}
                                                    <td class="five">{{c}}</td> 
                                                {% endfor %}
                                            </tr>
                                            {% endfor %}
                                        </table>
                                        <br>
                                    {% endfor %}              
                            {% endif %}
                        
                            {% if resultrecycle.Recycle_endreport_dict %}            
                                <p class="smallfour">{{ZQDindex}}.{{RECYCLEindex}} 加标回收实验(Recovery)</p>
                                    {% for r in resultrecycle.textlist %}
                                        <p class="five"> {{forloop.counter}}) {{r}}</p>
                                    {% endfor %}
                                    <p class="picture"><img src="/static/report/img/3.png" alt="" width="250px" height="45px"/></p>
                                <p class="five">{{resultrecycle.serial}}) 加标回收率实验结果表{{tableRECYCLEindex}}所示，由结果可知，
                                    方法的回收率：{{resultrecycle.Recycle_endconclusion}}满足检测要求。
                                </p>
                                {%for key,value in resultrecycle.Recycle_endreport_dict.items %}    
                                    <table class="mainbody" cellpadding="4" width="700" align="center">
                                    <caption>表{{tableRECYCLEindex}}.{{key}}验证结果验证结果</caption>
                                    <tr> 
                                        <th class="title topdown-1" colspan="3" width="43%">病人基质样本</th>
                                        <th class="title topdown-1" rowspan="2" width="17%">加标理论值({{Unitdict|get_item:key|default:unit}})</th>
                                        <th class="title topdown-1" colspan="2" width="28%">加标后样本</th>
                                        <th class="title topdown-1" rowspan="2" width="12%">回收率（%）</th>
                                    </tr>
                                    <tr>
                                        <th class="title topdown-1" width="15%">样本编号</th>
                                        <th class="title topdown-1" width="15%">平行检测浓度<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                        <th class="title topdown-1" width="15%">均值<br/>({{Unitdict|get_item:key|default:unit}})</th>                           
                                        <th class="title topdown-1" width="15%">样本编号</th>
                                        <th class="title topdown-1" width="15%">平行检测浓度<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                    </tr>
                                    {%for c,r in value.items %}
                                        <tbody border="1">
                                        <tr>
                                            <td class="five" rowspan="9">{{c}}</td> 
                                            <td class="five" rowspan="3">{{r.0}}</td>
                                            <td class="five" rowspan="9">{{r.27}}</td>
                                            <td class="five" rowspan="3">{{r.1}}</td>
                                            <td class="five" rowspan="3">{{r.2}}</td>
                                            <td class="five">{{r.3}}</td>
                                            <td class="five">{{r.6}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.4}}</td>
                                            <td class="five">{{r.7}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.5}}</td>
                                            <td class="five">{{r.8}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five" rowspan="3">{{r.9}}</td>
                                            <td class="five" rowspan="3">{{r.10}}</td>
                                            <td class="five" rowspan="3">{{r.11}}</td>
                                            <td class="five">{{r.12}}</td>
                                            <td class="five">{{r.15}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.13}}</td>
                                            <td class="five">{{r.16}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.14}}</td>
                                            <td class="five">{{r.17}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five" rowspan="3">{{r.18}}</td>
                                            <td class="five" rowspan="3">{{r.19}}</td>
                                            <td class="five" rowspan="3">{{r.20}}</td>
                                            <td class="five">{{r.21}}</td>
                                            <td class="five">{{r.24}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.22}}</td>
                                            <td class="five">{{r.25}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.23}}</td>
                                            <td class="five">{{r.26}}</td>
                                        </tr>
                                        </tbody>
                                    {% endfor %}
                                </table>  
                                    <br>
                                    {% endfor %}              
                                <br>
                            {% endif %} 
    
    <!------------------------------------------------------AMR------------------------------------------------------>     
                            {% if resultAMR.AMR_dict_report or resultLOD.objs or resultAMRconclusion%}
                                <p class="four" style="text-align:left;">{{AMRindex}}. 分析灵敏度与分析测量范围（Analytical Sensitivity and Analytical Measurement Range）</p>
                            {% endif %} 

                            {% if resultAMR.AMR_dict_report %}
                                <p class="smallfour">{{AMRindex}}.{{amrindex}} 方法定量限与线性范围（Limit of Quantitation and Linearity）</p>
                                    {% for r in resultAMR.textlist %}
                                        <p class="five"> {{forloop.counter}}) {{r}}</p>
                                    {% endfor %}
                                    <p class="five"> {{resultAMR.serial}}) 结果数据如表{{tableAMRindex}}和图{{pictureAMRindex_start}}-{{pictureAMRindex_end}}所示, {{resultAMR.AMR_textlist_end}}</p>
                                {%for key,value in resultAMR.AMR_dict_report.items %}
                                    <table class="mainbody" cellpadding="4" width="700" align="center">
                                        <caption>表{{tableAMRindex}}.{{key}}线性范围验证结果</caption>
                                        <tr>
                                            <th class="title topdown-1" width="16.67%">浓度序号</th>
                                            <th class="title topdown-1" width="16.67%">理论浓度<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                            <th class="title topdown-1" width="16.67%">检测值<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                            <th class="title topdown-1" width="16.67%">回收率<br/>（%）</th>
                                            <th class="title topdown-1" width="16.67%">平均回收率<br/>（%）</th>
                                            <th class="title topdown-1" width="16.67%">检测值CV<br/>（%）</th>
                                        </tr>
                                        {%for r in value %}
                                        <tr>
                                            <td class="five" rowspan="6">{{r.0}}</td> 
                                            <td class="five" rowspan="6">{{r.1}}</td>
                                            <td class="five">{{r.2}}</td>
                                            <td class="five">{{r.3}}</td>
                                            <td class="five" rowspan="6">{{r.14}}</td>
                                            <td class="five" rowspan="6">{{r.15}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.4}}</td>
                                            <td class="five">{{r.5}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.6}}</td>
                                            <td class="five">{{r.7}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.8}}</td>
                                            <td class="five">{{r.9}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.10}}</td>
                                            <td class="five">{{r.11}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.12}}</td>
                                            <td class="five">{{r.13}}</td>
                                        </tr>
                                        {% endfor %}
                                    </table> 
                                    <br> 
                                {% endfor %}
                                    
                                {% for obj in resultAMR.objs %}
                                    {% if key in obj.name  %}
                                        <p class="text-center"><img src="/media/{{ obj.img }}" alt="" width="500px" height="300px"></p>                          
                                        <p class="picture"> 图{{forloop.parentloop.counter|add:pictureAMRindex_start|add:-1}}. {{obj.name}}</p>
                                        <br> 
                                    {% endif %}
                                {% endfor %}                                                                       
                            {% endif %}
                        
    
                        {% if resultLOD.objs %}
                            <p class="smallfour">{{AMRindex}}.{{LODindex}} 方法检出限（Limit of Detection）</p>
                            {% for r in resultLOD.textlist %}
                                    <p class="five"> {{forloop.counter}}) {{r}}</p>
                                {% endfor %}
                            <p class="five"> {{resultLOD.serial}}) 结果数据如图{{pictureLODindex}}，{{resultLOD.LOD_conclusion}}</p>
                            <p>
                            {% for obj in resultLOD.objs %}
                                <p class="title"><img src="/media/{{ obj.img }}" alt="" width="500px" height="300px"></p>
                                <p class="picture"> 图{{pictureLODindex}}. {{obj.name}}</p>
                                <!-- <caption>图{{forloop.counter}}. {{obj.name}}</caption> -->
                                <br><br>  
                            {% endfor %} 
                            </p>
                        {% elif resultLOD.LOD_endreport_dict %}
                            <p class="smallfour">{{AMRindex}}.{{LODindex}} 方法检出限（Limit of Detection）</p>
                            <table class="mainbody" cellpadding="4" width="700" align="center">
                                <caption>表{{tableLODindex}}.{{key}}检出限验证结果</caption>
                                <tr>
                                    <th class="title left-1">样本编号</th>
                                    {%for key in resultLOD.LOD_endreport_dict.keys %}
                                        <th class="title right-1">{{key}}({{unit}})</th>
                                    {% endfor %}
                                </tr>
                                <tr>
                                    <td class="five">1</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.0}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">2</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.1}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">3</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.2}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">4</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.3}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">5</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.4}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">6</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.5}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">7</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.6}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">8</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.7}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">9</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.8}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">10</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.9}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">11</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.10}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">12</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.11}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">11</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.10}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">12</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.11}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">13</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.12}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">14</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.13}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">15</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.14}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">16</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.15}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">17</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.16}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">18</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.17}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">19</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.18}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">20</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.19}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">X</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.20}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">SD</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.21}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">LOD(3 SD)</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.22}}</td>
                                    {% endfor %}              
                                </tr>
                                <tr>
                                    <td class="five">LOD(10 SD)</td>
                                    {%for value in resultLOD.LOD_endreport_dict.values %}
                                        <td class="five">{{value.23}}</td>
                                    {% endfor %}              
                                </tr>
                            </table>
                        {% endif %}
    
                        {% if resultAMRconclusion %}
                        <p class="smallfour">{{AMRindex}}.{{AMRconclusionindex}} 结论（Summary of the AMR, LOQ and LOD study）</p>
                            <table class="mainbody" cellpadding="4" width="700" align="center">
                                <caption>表{{tableAMRconclusionindex}}.分析灵敏度与线性范围结果汇总</caption>
                                <tr>
                                    <th class="title topdown-1" style="width: 20%;">化合物</th>
                                    <th class="title topdown-1">方法检出限LOD</th>
                                    <th class="title topdown-1">方法定量限LOQ</th>
                                    <th class="title topdown-1" style="width: 30%;">分析测量范围AMR</th>
                                </tr>
                                {%for key,value in resultAMRconclusion.AMRconclusiontabledict.items %}
                                <tr>
                                    <td class="five">{{key}}({{unit}})</td>
                                    <td class="five">{{value.0}}</td>
                                    <td class="five">{{value.1}}</td>
                                    <td class="five">{{value.2}}</td>
                                </tr> 
                                {% endfor %}           
                            </table>
                        {% endif %}
                            
 <!------------------------------------------------------稀释倍数------------------------------------------------------>        
                        {% if resultCRR%}
                            <p class="four" style="text-align:left;">{{CRRindex}}. 临床可报告范围（Clinical Reportable Range）</p>   
                            <p class="smallfour">{{CRRindex}}.{{crrindex}} 稀释倍数验证（Dilution）</p> 
                                {% for r in resultCRR.textlist %}
                                    <p class="five"> {{forloop.counter}}) {{r}}</p>
                                {% endfor %}
                                <p class="five"> {{resultCRR.serial}}) 实验结果如表{{tableCRRindex}}所示，对高浓度样本按照{{resultCRR.CRR_conclusion1}}倍稀释后得到的检测结果满足要求。
                                    因此，当遇到超出标准曲线最高浓度点的样本时，可对其稀释{{resultCRR.CRR_conclusion1}}倍后进行检测。</p>
                            {%for key,value in resultCRR.CRR_endreport_dict.items %}
                                <table class="mainbody" cellpadding="4" width="700" align="center">
                                    <caption>表{{tableCRRindex}}.{{key}}稀释倍数验证结果</caption>
                                    <tr>
                                        <th class="title topdown-1" width="16%">稀释倍数</th>
                                        <th class="title topdown-1" width="20%">检测浓度<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                        <th class="title topdown-1" width="24%">检测浓度平均值<br/>({{Unitdict|get_item:key|default:unit}})</th>
                                        <th class="title topdown-1" width="22%">检测浓度CV(%)</th>
                                        <th class="title topdown-1" width="18%">回收率(%)</th>
                                    </tr>
                                    {%for r in value%}
                                        <tr>
                                            <td class="five" rowspan="5">{{r.0}}</td>
                                            <td class="five">{{r.1}}</td>
                                            <td class="five" rowspan="5">{{r.11}}</td>
                                            <td class="five" rowspan="5">{{r.12}}</td>
                                            <td class="five">{{r.6}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.2}}</td>
                                            <td class="five">{{r.7}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.3}}</td>
                                            <td class="five">{{r.8}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.4}}</td>
                                            <td class="five">{{r.9}}</td>
                                        </tr>
                                        <tr>
                                            <td class="five">{{r.5}}</td>
                                            <td class="five">{{r.10}}</td>
                                        </tr>
                                    {% endfor %}
                                </table>        
                                <br>  
                            {% endfor %}
                            <p class="smallfour">{{CRRindex}}.{{crrindex|add:1}} 临床可报告范围（Clinical Reportable Range）</p>
                            <p class="five"> 按照线性范围（AMR）和稀释倍数验证结果，临床可报告范围（CRR）的下限即为AMR的下限，CRR的上限即为最大稀释倍数乘以AMR的上限。
                                {{resultCRR.CRR_conclusion2}}</p>
                            <br>            
                        {% endif %}    
                        
    
<!------------------------------------------------------基质特异性------------------------------------------------------>        
                        {% if resultMS%}
                            <p class="four" style="text-align:left;">{{MSindex}}. 基质特异性（Matrix Specificity）</p>    
                                {% for r in resultMS.MS_textlist_general %}
                                <p class="five"> {{forloop.counter}}) {{r}}</p>
                                {% endfor %}
                                <p class="five"> {{resultMS.serial}}) 如图{{pictureMSindex}}所示， {{resultMS.conclusion}}</p>
                            <p>
                                {% for obj in resultMS.dataMS %}
                                    <p class="title"><img src="/media/{{ obj.img }}" alt="" width="700px" height="400px"></p>
                                    <p class="picture"> 图{{forloop.counter}}. {{obj.name}}</p>
                                    <br> 
                                {% endfor %}        
                            </p> 
                        {% endif %}   

<!------------------------------------------------------基质效应------------------------------------------------------>                           
                        {% if resultMatrix_effect%}
                            <p class="four" style="text-align:left;">{{Matrix_effectindex}}. 基质效应（Matrix effect）</p>   
                                {% for r in resultMatrix_effect.textlist %}
                                <p class="five"> {{forloop.counter}}) {{r}}</p>
                                {% endfor %}
                                <p class="five"> {{resultMatrix_effect.serial}}) 结果如表{{tableMatrix_effectindex}}所示，混合样本中的响应值与高低浓度样本和病人样本中的响应值的均值差异均小于20%，说明无相对基质效应。</p>
                            {%for key,value in resultMatrix_effect.Matrixeffect_endreport_dict.items %}
                                <table class="mainbody" cellpadding="4" width="700" align="center">
                                    <caption>表{{tableMatrix_effectindex}}.{{key}}验证结果</caption>
                                    <tr>
                                        <th class="title topdown-1" width="8%">样本编号</th>
                                        <th class="title topdown-1" width="15%">Area</th>
                                        <th class="title topdown-1" width="15%">IS Area</th>
                                        <th class="title topdown-1" width="15%">Area/<br>IS Area</th>
                                        <th class="title topdown-1">Area/<br>IS Area<br>的平均值</th>
                                        <th class="title topdown-1">混合样本<br>Area/<br>IS Area<br>的理论值</th>
                                        <th class="title topdown-1">偏差(%)</th>
                                    </tr>   
                                    {%for i,j in value.items %}
                                    <tr>      
                                        <td class="five" rowspan="3">{{i}}</td>
                                        <td class="five">{{j.0}}</td>
                                        <td class="five">{{j.1}}</td>
                                        <td class="five">{{j.2}}</td>
                                        <td class="five" rowspan="3">{{j.9}}</td>
                                        <td class="five" rowspan="3">{{j.10}}</td>
                                        <td class="five">{{j.11}}</td>
                                    </tr>
                                    <tr>
                                        <td class="five">{{j.3}}</td>
                                        <td class="five">{{j.4}}</td>
                                        <td class="five">{{j.5}}</td>                              
                                        <td class="five">{{j.12}}</td>
                                    </tr>
                                    <tr>
                                        <td class="five">{{j.6}}</td>
                                        <td class="five">{{j.7}}</td>
                                        <td class="five">{{j.8}}</td>
                                        <td class="five">{{j.13}}</td>
                                    </tr>
                                    {% endfor %} 
                                </table>
                                <br>
                            {% endfor %} 
                        {% endif %} 
                        
   
 <!------------------------------------------------------携带效应------------------------------------------------------>        
                        {% if resultCarryover%}
                            <p class="four" style="text-align:left;">{{Carryoverindex}}. 携带效应（Carryover）</p>  
                                {% for r in resultCarryover.textlist %}
                                <p class="five"> {{forloop.counter}}) {{r}}</p>
                                {% endfor %}
                                <p class="five"> {{resultCarryover.serial}}) 实验结果如表{{tableCarryoverindex}}所示,（C3mean-C1mean）/C1mean均小于20%，
                                    说明系统无携带效应，满足检测要求。</p>
                            <p> 
                                {% if Carryover2_True %}      
                                    <table class="mainbody" cellpadding="4" align="center">
                                        <caption>表{{tableCarryoverindex_start}}.{{key}}验证结果</caption>
                                        <tr>
                                            <th class="title left-1" rowspan="2" width="12%">样本编号</th>
                                            <th class="title right-1" colspan="7">检测结果({{Unitdict|get_item:key|default:unit}})或偏差（%）</th>
                                        </tr> 
                                        <tr>
                                            {%for key in resultCarryover.Carryover_endreport_dict.keys %}
                                                <td class="title right-1">{{key}}</td>
                                            {% endfor %}
                                        </tr>                              
                                        <tr>
                                            <td class="five">L01</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.0}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L02</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.1}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L03</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.2}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H04</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.3}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H05</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.4}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L06</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.5}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H07</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.6}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H08</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.7}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L09</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.8}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L10</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.9}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L11</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.10}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L12</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.11}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H13</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.12}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H14</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.13}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L15</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.14}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H16</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.15}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H17</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.16}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L18</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.17}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H19</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.18}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">H20</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.19}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">L21</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.20}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">X1</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.21}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">X2</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                            <td class="five">{{value.22}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">X2-X1</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.23}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">SD1</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.24}}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <td class="five">3SD1</td>
                                            {%for value in resultCarryover.Carryover_endreport_dict.values %}
                                                <td class="five">{{value.25}}</td>
                                            {% endfor %}
                                        </tr>                                  
                                    </table>                                                         
                                    <br> 
                                {% else %}                             
                                    {%for key,value in resultCarryover.d_reshape.items %}   
                                        <table class="mainbody" cellpadding="4" width="700"  align="center">
                                        <caption>表{{tableCarryoverindex_start}}. 携带效应验证结果</caption>
                                            <tr>
                                                <th class="title topdown-1"" rowspan="2" width="24%">样本编号</th>
                                                <th class="title topdown-1"">检测结果（{{unit}}）或偏差（%）</th>
                                            </tr>
                                            <tr>
                                                {%for c in value.keys %}
                                                    <td class="title topdown-1"">{{c}}</td>
                                                {% endfor %}
                                            </tr> 
                                            <tr>
                                                <td class="five">C1</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.0}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C2</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.1}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C3</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.2}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C1</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.3}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C2</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.4}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C3</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.5}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C1</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.6}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C2</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.7}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C3</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.8}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C1mean</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.9}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">C3mean</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.10}}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <td class="five">(C3mean-C1mean)/C1mean</td>
                                                {%for r in value.values %}
                                                    <td class="five">{{r.11}}</td>
                                                {% endfor %}
                                            </tr>         
                                        </table>
                                        <br> 
                                    {% endfor %}
                                {% endif %}
                            </p> 
                        {% endif %}  


 <!------------------------------------------------------稳定性------------------------------------------------------>                        
                        

 <!------------------------------------------------------最终结论------------------------------------------------------>                  
                        {% if resultEnd_conclusion %}
                            <p class="four" style="text-align:left;">{{titleindex|add:1}}. 结论（Conclusion）</p>   
                            <p class="five" > {{resultEnd_conclusion.0}}</p>
                        {% endif %} 
                        
                        <table cellpadding="8">
                            <tr>
                                <td class="end">&#12288</td>
                                <td class="end">报告编辑人：<input type="text" id="Report_Investigator" name="Report.Investigator"></td>
                                <td class="end">&#12288&#12288&#12288&#12288</td>
                                <td class="end">日期(Date)：<input type="date" id="Report_InvestigationDate" name="Report.InvestigationDate"></td>
                            </tr>
                            <tr>
                                <td class="end">&#12288</td>
                                <td class="end">报告审核人：<input type="text" id="Report_Approver" name="Report.Approver"></td>
                                <td class="end">&#12288&#12288&#12288&#12288</td>
                                <td class="end">日期(Date)：<input type="date" id="Report_ApprovalDate" name="Report.ApprovalDate"></td>
                            </tr>
                            <tr>
                                <td class="end">&#12288</td>
                                <td class="end">报告批准人：<input type="text" id="Report_Approver" name="Report.Approver"></td>
                                <td class="end">&#12288&#12288&#12288&#12288</td>
                                <td class="end">日期(Date)：<input type="date" id="Report_ApprovalDate" name="Report.ApprovalDate"></td>
                            </tr>
                        </table>
               
                    <br><br>
                    <p class="row">
                        <p class="col-md-12 d-print-none">
                            <input type="button" id="print" value="导出pdf" class="btn btn-danger" onclick="printPage()">
                        </p>
                        <br>
                        <p class="col-md-12 d-print-none"><button id="copyBtn" data-clipboard-target="#content" class="btn btn-danger">复制到word</button></p>
                    </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>

    
    <!--需增加js设置不打印末尾两页空白页的代码-->
    <script language="javascript">

        var clipboard = new ClipboardJS("#copyBtn");
        clipboard.on('success',function(e){
            alert("已复制到剪贴板");
        });

        clipboard.on('error',function(e){
            alert("异常错误："+JSON.stringify(e));
        });

        function printPage() {
            // document.getElementsByID("edit").removeAttribute("hidden");
            document.body.style = "padding-top: 0mm;";  //打印时把首页上方边距调为0，必须点击打印按钮才可以
            window.print();
            document.body.style = "";
        }

        function edit(){
            javascript:document.body.contentEditable='true';document.designMode='on'; void 0;
            alert("进入编辑状态,编辑完毕后无需刷新页面,直接打印即可")
        }

        let english_title = "{{ english_title }}"; //英文标题
        let chinese_title = "{{ chinese_title }}"; //中文标题
        let h = 889;  //每页纸的高度，单页A4纸总高度（不同的浏览器打印高度不一致，根据自己需求调整）
        let bodyEle = $('body');
        let bodyHeight = bodyEle.height(); //获取页面总长度 
        let count = Math.ceil(bodyHeight/h); //获取页数
        console.log(count);
        console.log(bodyHeight);

        //动态添加页码 通过绝对定位
        for(let i = 0; i < count; i++){
            var topValue1 = Number(h * (i + 1)) + Number(22* i) + Number(211* (i+1)) - Number(25);
            var topValue2 = Number(h * (i + 1)) + Number(22* i) + Number(211* (i+1)) - Number(10);
                
            let foot_englishtitle = '<div class="tfoot d-none d-print-block" id="englishtitle" style="position:absolute;top:' + topValue1 + 'px;left:40px;">' + english_title + '</div>';
            let foot_chinesetitle = '<div class="tfoot d-none d-print-block" style="position:absolute;top:' + topValue2 + 'px;left:40px;">' + chinese_title + '</div>';  
            let foot_PAGE = '<div class="tfoot d-none d-print-block" style="position:absolute;top:' + topValue2 + 'px;right:60px;">' + 'PAGE' +' '+ (i + 1) + '/' + count+ '</div>';  
    
            bodyEle.append(foot_PAGE)
            bodyEle.append(foot_englishtitle);
            bodyEle.append(foot_chinesetitle);           
        }
    </script>
    {% endblock %}