{% extends "report/layout.html" %} 
{% block content %} 

<!--CSS-->
<style>
    .deleteall{
        font-size: 18.6px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: left;
    }

    /* 一 封面 */
    .covertr,.covertd{
        /* 设置固定高度，保证封面打印时独占第一页 */
        display: block;
        height: 889px; 
        /* background-color: #bfa; */
    }

    /* 中英文大标题 */
    .Cover_englishtitle_big,.Cover_chinesetitle_big{
        font-size: 24px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;
        line-height: 100px;
    }

    .Cover_englishtitle_big{
        margin-top: 20px;
    }

    /*中英文小标题*/
    .Cover_englishtitle_small,.Cover_chinesetitle_small {
        font-size: 18.6px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;
        line-height: 100px;
    }

    /* 仪器编号，仪器型号，色谱柱 */
    .Cover_instrumentnumber,.Cover_instrumentmodel,.Cover_column{
        font-size: 18.6px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;
        line-height: 50px;
    }

    .Cover_column{
        margin-bottom: 30px;
    }

    /*ProtocolID，代码*/
    .Cover_ProtocolID,.Cover_code {
        font-size: 20px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;
        line-height: 70px;
    }


    /* 二 前言 */

    /* 外层td容器上下padding为0，左右为25 */
    .prefacetd{
        padding: 0px 25px;
    }

    /* 非表格中的正文样式 */
    .maintext{
        font-size: 14px;
        font-family: Times New Roman, 宋体;
        text-indent: 2em;
        line-height: 40px;
        text-align: justify;
    }

    /* 表格中的正文样式 */
    .tablemaintext{
        font-size: 14px;
        font-family: Times New Roman, 宋体;
        text-align:center
    }

    .Preface_chinesetitle{
        font-size: 20px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;
        line-height: 40px;
        /* margin-top: -60px; */
    }

    .ValidationReason,.Instrument_Conditions,.Instrument,.Reagents_Consumables,.SamplePreparation{
        font-size: 18.6px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: left;
        line-height: 40px;
    }

    .MSMethod,.HPLCMethod,.DetectionEquipment,.AuxiliaryEquipment,.Reagents,.Consumables{
        font-size: 16px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: left;
        line-height: 40px;
    }

    .MSMethodTable,.HPLCMethodTable{
        table-layout: fixed; /*table表格宽度固定，同时td内容过长也不会被撑开*/  
        word-break: break-all;  
        border-collapse: collapse;  /* 关键属性：合并表格内外边框(其实表格边框有2px，外面1px，里面还有1px) */    
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        width: 580px;
        margin: 0 auto; /*居中 */ 
    }

    .MSMethodTabletr th{
        /* 字体加粗居中 */
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;

        /* 设置下边框 */
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        border-top: none;
    }

    .HPLCMethodTabletr th{
        /* 字体加粗居中 */
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;

        /* 设置下边框 */
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        font-weight: bold;
        width: 20%;
    }

    /* 三 验证数据 */

    /* 每个验证指标外层容器td，设置padding25px */
    .jmdtd,.stabilitytd,.reference_intervaltd{
        padding: 0px 25px;
    }

    /* 每个验证指标一级标题 */
    .JMD_title,.Stability_title,.ReferenceInterval_title{
        font-size: 18.6px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: left;
        line-height: 40px;
    }

    /* 每个验证指标二级标题 */
    .PNJMD_title{
        font-size: 16px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: left;
        line-height: 40px;
    }

    /* 每个验证指标下的表格 */
    .PNjmd_Table{
        table-layout: fixed; /*table表格宽度固定，同时td内容过长也不会被撑开*/  
        word-break: break-all;  
        border-collapse: collapse;  /* 关键属性：合并表格内外边框(其实表格边框有2px，外面1px，里面还有1px) */    
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        width: 580px;
        margin: 0 auto; /*居中 */ 
    }

    /* 每个验证指标下的表格的表头 */
    .PNjmd_Tabletr th{
        /* 字体加粗居中 */
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;

        /* 设置下边框 */
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        font-weight: bold;
    }

    /* ------------------------------------- */
    /*四号字体*/
    p.smallfour {
        font-size: 16px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        line-height: 25px;
    }

    /*小四号字体*/
    five {
        font-size: 14px;
        font-family: Times New Roman, 宋体;
        text-indent: 2em;
        line-height: 25px;
        text-align: justify;
    }

    /*五号字体*/
    pre.five {
        font-size: 14px;
        font-family: Times New Roman, 宋体;
        text-indent: 2em;
        line-height: 25px;
        background-color: white;
        border: white;
    }

    /*页眉页脚格式*/
    div.thead {
        font-size: 14px;
        font-family: Times New Roman, 宋体;
        text-align: center;
    }

    div.tfoot {
        font-size: 14px;
        font-style: oblique;
        font-family: Times New Roman, 宋体;
        color: rgba(255, 255, 255, 0);
    }

    pageFooter {
        display: table-footer-group;
    }

    pageFooter:after {
        counter-increment: page;
        content: counter(page);
    }

    /*表格格式*/

    table.mainbody {
        table-layout: fixed;
        /*table表格宽度固定，同时td内容过长也不会被撑开*/
        word-break: break-all;
        /*table表格宽度固定，同时td内容过长也不会被撑开*/
        border-collapse: collapse;
        /* 关键属性：合并表格内外边框(其实表格边框有2px，外面1px，里面还有1px哦) */
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        width: 580px;
    }

    .down-1 {
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        border-top: none;
    }

    .topdown-1 {
        border: 2px solid #000;
        border-left: none;
        border-right: none;
        text-align: center;
        font-weight: bold;
    }

    table.always {
        page-break-after: always;
    }

    .always:last-child {
        page-break-after: auto;
    }

    /* 解决打印时多出一页的问题 */

    caption {
        font-size: 16px;
        font-weight: bold;
        font-family: Times New Roman, 宋体;
    }

    thead.report-header {
        display: table-header-group;
    }

    tfoot.report-footer {
        display: table-footer-group;
        bottom: 0;
        left: 0;
        /* position: fixed; */
        right: 0;
    }

    th.title {
        font-weight: bold;
        font-family: Times New Roman, 宋体;
        text-align: center;
    }

    td.five {
        font-family: Times New Roman, 宋体;
        text-align: center;
    }

    /*五号字体*/
    td.end {
        border: 1px solid transparent;
    }

    /*报告编辑处的表格*/
    td.bottom {
        border-bottom: none;
    }

    /*报告的表格不显示底部边框*/
    td.top {
        border-top: none;
    }

    /*报告的表格不显示顶部边框*/
    div.offset {
        position: relative;
        left: 0px;
        top: 20px;
    }

    /*图片格式*/
    p.picture {
        font-size: 14px;
        font-family: Times New Roman, 宋体;
        font-weight: bold;
        text-align: center;
    }

    /*图片*/

    /*输入框格式*/
    input {
        border-bottom: 1px solid #000;
        border-top: 0px;
        border-left: 0px;
        border-right: 0px;
    }

    body {
        margin：0
    }
</style>

{% load myfilter %}
<body>
    <form action="{% url 'reportdeleteselect' %}" method="POST">
        <h2 style="color: red;">请勾选您要删除的验证指标</h2>
        <div class="deleteall"><input type="checkbox" name="quota" value="all" unchecked>删除整份报告</div>
        <div class="mainreport">
            <table class="always" width="100%" style="height: 490px;" cellpadding="25"> <!--cellpadding="25"设置打印时的内外边距-->
                <thead class="report-header">
                <tr>
                    <th class="report-header-cell">
                        <div class="text-left"><img src="/static/report/img/4.png" height="35px" width="90px"/></div>
                        <div class="thead">广州金域医学检验中心有限公司</div>  
                        <div class="thead">Guangzhou Kingmed Center for Clinical Laboratory</div> 
                         <!--页眉文字下方添加横线的代码-->    
                        <div style="width:100%; height:2px; border-top:1.2px solid 	#000000; clear:both;"></div> 
                    </th>
                </tr>
                </thead>

                <tfoot class="report-footer" style="display:table-footer-group;font-weight:bold">
                    <tr>
                        <td class="report-footer-cell">
                            <div class="tfoot">&#12288</div>
                            <div class="tfoot">&#12288</div>
                        </td>
                    </tr>
                </tfoot>

                <!--------------------------------------------------正文-------------------------------------------------->
                <tbody class="report-content">              
                    <!--------------------------------------------封面-------------------------------------------->
                    <tr class="covertr">
                        <td class="covertd">

                            <!--英文大标题-->
                            <div class="Cover_englishtitle_big">VALIDATION PROTOCOL AND REPORT</div>

                            <!--中文大标题-->
                            <div class="Cover_chinesetitle_big">方法验证报告</div>

                            <!--英文小标题-->
                            {% if english_title %}
                                <div class="Cover_englishtitle_small">{{english_title}}</div>
                            {% else %}
                                <div class="Cover_englishtitle_small">英文标题未设置!</div>
                            {% endif %}

                            <!-- 中文小标题 -->
                            {% if chinese_title %}
                                <div class="Cover_chinesetitle_small">{{chinese_title}}</div>
                            {% else %}
                                <div class="Cover_chinesetitle_small">中文标题未设置!</div>
                            {% endif %}

                            <!-- 仪器编号，仪器型号，色谱柱 -->
                        <div class="Cover_instrumentnumber">仪器编号:{{Instrument_number}}</div>
                        <div class="Cover_instrumentmodel">仪器型号:{{Instrument_model}}</div>
                        <div class="Cover_column">色谱柱:{{Column}}</div>

                        <!-- Protocol ID，代码 -->
                        <div class="Cover_ProtocolID">Protocol ID:{{Protocol_ID}}</div>
                        <div class="Cover_code">代码:{{Protocol_ID}}</div>
                        </td>
                    </tr>

                    <!-------------------------------------------- 一 前言:验证原因，仪器条件，设备...-------------------------------------------->
                    <tr class="prefacetr">
                        <td class="prefacetd">
                            {% if chinese_title %}
                                <div class="Preface_chinesetitle">{{chinese_title}}</div>               
                            {% else %}
                                <div class="Preface_chinesetitle">中文标题未设置!</div>                  
                            {% endif %}
                            <div class="ValidationReason">1. 验证原因(Validation Reason)</div>
                            <div class="maintext">{{text_Validation_Reason.0}}</div>

                            <!--------------------------------------------仪器条件-------------------------------------------->
                            <div class="Instrument_Conditions">2. 仪器条件(Instrument Conditions)</div>
                            <div class="maintext">检测仪器:{{Instrument_model}}(仪器编号:{{Instrument_number}})</div>
                            <div class="maintext">色谱柱:{{Column}}</div>

                            <!----------------------质谱方法-------------------------->
                            <div class="MSMethod">2.1 质谱方法(MS Method)</div>
                            {% for r in Test_method_data.zp_method_texts_list %}
                                <div class="maintext">{{r}}</div>
                            {% endfor %}

                            <!----------------------质谱方法-------------------------->
                            <table class="MSMethodTable" cellpadding="4">
                                <caption>表1.质谱参数</caption>
                                <tr class="MSMethodTabletr">
                                    <th width="20%">分析物名称</th>
                                    <th>母离子</th>
                                    <th>子离子</th>
                                    <th>TIME(S)</th>
                                    <th width="20%">CONE(V)</th>
                                    <th width="20%">COLLISION(V)</th>
                                </tr>
                                {% for r in Test_method_data.zp_method_list %}
                                <tr>
                                    {% for c in r %}
                                        <td class="tablemaintext">{{c}}</td>
                                    {% endfor %}
                                </tr>
                                {% endfor %}
                            </table>
                            
                            <!----------------------液相方法-------------------------->
                            <div class="HPLCMethod">2.2 液相方法(HPLC Method)</div>
                            {% for r in Test_method_data.yx_method_texts_list %}
                                <div class="maintext">{{r}}</div>
                            {% endfor %}
                            <table class="HPLCMethodTable" cellpadding="4">
                                <caption>表2.液相梯度条件</caption>
                                <tr class="HPLCMethodTabletr">
                                    <th>步骤</th>
                                    <th>分析时间(min)</th>
                                    <th>流速(mL/min)</th>
                                    <th>流动相B%</th>
                                    <th>流动相A%</th>
                                </tr>
                                {% for r in Test_method_data.yx_method_list %}
                                <tr>
                                    {% for c in r %}
                                        <td class="tablemaintext">{{c}}</td>
                                    {% endfor %}
                                </tr>
                                {% endfor %}
                            </table>
                            
                            <!---------------------------------------------设备---------------------------------------------->
                            <div class="Instrument">3. 设备(Instrument)</div>
                            <div class="DetectionEquipment">3.1 检测设备(Detection equipment)</div>
                            {% for r in Equipment_data.Detection_equipment_texts_list %}
                                <div class="maintext">{{r}}</div>
                            {% endfor %}
                            
                            <div class="AuxiliaryEquipment">3.2 辅助设备(Auxiliary equipment)</div>
                            {% for r in Equipment_data.Auxiliary_equipment_texts_list %}
                                <div class="maintext">{{r|linebreaksbr}}</div>
                            {% endfor %}

                            <!-------------------------------------------试剂耗材-------------------------------------------->
                            <div class="Reagents_Consumables">4. 试剂和耗材(Reagents and Consumables)</div>
                            <div class="Reagents">4.1 主要试剂(Reagents)</div>
                            {% for r in Reagents_Consumables_data.reagents_texts_list %}
                                <div class="maintext">{{r}}</div>
                            {% endfor %}

                            <div class="Consumables">4.2 主要耗材(Consumables)</div>
                            {% for r in Reagents_Consumables_data.consumables_texts_list %}
                                <div class="maintext">{{r}}</div>
                            {% endfor %}

                            <!-------------------------------------------样品处理------------------------------------------->
                            <div class="SamplePreparation">5. 样品处理(Sample Preparation)</div>
                            {% for r in Sample_Preparation_data.Sample_Preparation_texts_list %}
                                <div class="maintext">{{r}}</div>
                            {% endfor %}
                        </td>
                    </tr>

                    <!----------------------------------------------------- 二 验证数据 ------------------------------------------------------>
                    <!-------------------------------------------1 精密度------------------------------------------->
                    {% if PNjmd_data.JMD_endreport_dict or PJjmd_data.JMD_endreport_dict %} 
                        <tr class="jmdtr">
                            <td class="jmdtd">
                                <div class="JMD_title">{{JMDindex}}. 精密度（Precision）</div>
                                <!-- 1.1 重复性精密度实验数据 -->
                                {% if PNjmd_data.JMD_endreport_dict %}
                                    <div class="PNJMD_title"><input type="checkbox" name="quota" value="重复性精密度" unchecked>{{JMDindex}}.{{PNjmdindex}} 重复性精密度（Intra-assay Precision）</div>
                                    {% for r in PNjmd_data.textlist %}
                                        <div class="maintext"> {{forloop.counter}}) {{r}}</div>
                                    {% endfor %}
                                    <div class="maintext">{{PNjmd_data.serial}})表{{tablePNindex}} 即为重复性精密度数据，{{PNjmd_data.JMD_CONCLUSION}}</div>
                                    
                                    {%for key,value in PNjmd_data.JMD_endreport_dict.items %}
                                        <table class="PNjmd_Table" cellpadding="4">
                                            <caption>表{{tablePNindex}}. {{key}}重复性精密度实验数据</caption>
                                            {% if PNjmd_data.lownum %}
                                                <tr class="PNjmd_Tabletr">
                                                    <th>实验号</th>
                                                    <th>中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th>高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% elif PNjmd_data.mediannum %}
                                                <tr class="PNjmd_Tabletr">
                                                    <th>实验号</th>
                                                    <th>低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th>高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% elif PNjmd_data.highnum %}
                                                <tr class="PNjmd_Tabletr">
                                                    <th>实验号</th>
                                                    <th>低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th>中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% else %}
                                                <tr class="PNjmd_Tabletr">
                                                    <th>实验号</th>
                                                    <th>低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th>中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th>高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% endif %}
                                            {% for r in value %}
                                                <tr>
                                                    {% for c in r %}
                                                        <td class="five">{{c}}</td>
                                                    {% endfor %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                        <br>
                                    {% endfor %}
                                    <br>
                                {% endif %}

                                <!-- 1.2 中间精密度实验数据 -->
                                {% if PJjmd_data.JMD_endreport_dict %}
                                    <div class="smallfour"><input type="checkbox" name="quota" value="中间精密度" unchecked>{{JMDindex}}.{{PJjmdindex}} 中间精密度（Inter-assay Precision）</div>
                                    {% for r in PJjmd_data.textlist %}
                                        <div class="five"> {{forloop.counter}}) {{r}}</div>
                                    <br>
                                    {% endfor %}
                                    <div class="five">{{PJjmd_data.serial}}) 表{{tablePJindex_start}}-{{tablePJindex_end}} 即为中间精密度数据，{{PJjmd_data.JMD_CONCLUSION}}</div>

                                    {%for key,value in PJjmd_data.JMD_endreport_dict.items %}
                                        <table class="mainbody" cellpadding="4" align="center">
                                            <caption>表{{forloop.counter|add:tablePJindex_start|add:-1}}. {{key}}中间精密度实验数据</caption>
                                            {% if PJjmd_data.lownum %}
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% elif PJjmd_data.mediannum %}
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% elif PJjmd_data.highnum %}
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% else %}
                                                <tr>
                                                    <th class="title topdown-1">实验号</th>
                                                    <th class="title topdown-1">低浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">中浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                    <th class="title topdown-1">高浓度({{Unitdict|get_item:key|default:unit}})</th>
                                                </tr>
                                            {% endif %}
                                            {% for r in value %}
                                                <tr>
                                                    {% for c in r %}
                                                        <td class="five">{{c}}</td>
                                                    {% endfor %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                        <br>
                                    {% endfor %}
                                    <br>
                                {% endif %}

                                <!-- 1.3 精密度实验结果汇总 -->
                                {% if PNjmd_data.JMD_endreport_dict and PJjmd_data.JMD_endreport_dict %}
                                    <div class="smallfour">{{JMDindex}}.{{JMDconclusionindex}} 精密度验证结果汇总（Summary of the precisionstudy）</div>
                                    <div class="five">精密度实验验证结果如表{{tableJMDconclusionindex}}所示，{{jmdconclusion_data.JMD_CONCLUSION}}</div>

                                    <table class="mainbody" cellpadding="4" align="center">
                                        <caption>表{{tableJMDconclusionindex}}. 精密度实验结果汇总</caption>
                                        <tr>
                                            <th class="title topdown-1">化合物</th>
                                            <th class="title topdown-1">类别</th>
                                            <th class="title topdown-1" width="27%">项目</th>
                                            <th class="title topdown-1" width="13%">低浓度</th>
                                            <th class="title topdown-1" width="13%">中浓度</th>
                                            <th class="title topdown-1" width="13%">高浓度</th>
                                        </tr>
                                        {%for key,value in jmdconclusion_data.JMD_CONCLUSION_table.items %}
                                            <tr>
                                                <td class="five down-1" rowspan="6">{{key}}</td>
                                                <td class="five" rowspan="3">重复性精密度</td>
                                                <td class="five">测定次数（次）</td>
                                                <td class="five">{{value.0}}</td>
                                                <td class="five">{{value.1}}</td>
                                                <td class="five">{{value.2}}</td>
                                            </tr>
                                            <tr>
                                                <td class="five">平均值（{{Unitdict|get_item:key|default:unit}}）</td>
                                                <td class="five">{{value.3}}</td>
                                                <td class="five">{{value.4}}</td>
                                                <td class="five">{{value.5}}</td>
                                            </tr>
                                            <tr>
                                                <td class="five">CV（%）</td>
                                                <td class="five">{{value.6}}</td>
                                                <td class="five">{{value.7}}</td>
                                                <td class="five">{{value.8}}</td>
                                            </tr>
                                            <tr>
                                                <td class="five down-1" rowspan="3">中间精密度</td>
                                                <td class="five">测定次数（次）</td>
                                                <td class="five">{{value.9}}</td>
                                                <td class="five">{{value.10}}</td>
                                                <td class="five">{{value.11}}</td>
                                            </tr>
                                            <tr>
                                                <td class="five">平均值（{{Unitdict|get_item:key|default:unit}}）</td>
                                                <td class="five">{{value.12}}</td>
                                                <td class="five">{{value.13}}</td>
                                                <td class="five">{{value.14}}</td>
                                            </tr>
                                            <tr>
                                                <td class="five down-1">CV（%）</td>
                                                <td class="five down-1">{{value.15}}</td>
                                                <td class="five down-1">{{value.16}}</td>
                                                <td class="five down-1">{{value.17}}</td>
                                            </tr>
                                        {% endfor %}
                                    </table>
                                    <br>
                                {% endif %}
                            </td>
                        </tr>                                     
                    {% endif %}
                </tbody>
            </table>
        </div>
        <input hidden = "hidden" value="{{id}}" name="id">
        <input type="submit" value="确认删除" class="btn btn-danger" onclick="alert('删除成功!')">
        |
        <a href="{% url 'generation' %}">返回</a>
    </form>
</body>

{% endblock %}